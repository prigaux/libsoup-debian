--- libsoup/soup-headers.c~	2006-11-05 22:52:59.000000000 +0100
+++ libsoup/soup-headers.c	2007-01-02 18:29:44.973388500 +0100
@@ -32,6 +32,8 @@
 	int offset = 0, lws = 0;
 
 	key = strstr (str, "\r\n");
+	if (!key)
+		return FALSE;
 	key += 2;
 
 	/* join continuation headers, using a comma */
